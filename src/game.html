<!DOCTYPE html>
<html>

<head>
    <title>Game</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            background: #696969;
        }

        canvas {
            border: 1px solid white;
        }
    </style>
</head>

<body>
    <canvas id="gameCanvas" width="800" height="600"></canvas>
    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        // Player attributes
        const player = {
            x: 50,
            y: 450,
            width: 30,
            height: 30,
            dy: 0,
            gravity: 0.9,
            jumpHeight: -10,
            doubleJump: -15,
            jumps: 0,
        };

        let score = 0;
        let health = 100;
        let obstacles = [];

        // Handle keyboard events
        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space') {
                if (player.jumps < 1) {
                    player.dy = player.jumpHeight;
                    player.jumps++;
                } else if (player.jumps < 2) {
                    player.dy = player.doubleJump;
                    player.jumps++;
                }
            }
        });

        function gameLoop() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Draw background (parallax)
            drawBackground();

            // Update player position
            player.dy += player.gravity;
            player.y += player.dy;
            if (player.y > 450) {
                player.y = 450;
                player.dy = 0;
                player.jumps = 0;
            }

            // Draw player
            ctx.fillStyle = 'white';
            ctx.fillRect(player.x, player.y, player.width, player.height);

            // Randomly generate obstacles
            if (Math.random() < 0.01) {
                obstacles.push({
                    x: canvas.width,
                    y: 500,
                    size: 30 + Math.random() * 30,
                });
            }

            // Draw and move obstacles
            for (let i = obstacles.length - 1; i >= 0; i--) {
                ctx.fillStyle = 'red';
                drawTriangle(obstacles[i].x, obstacles[i].y, obstacles[i].size);
                obstacles[i].x -= 4;

                if (obstacles[i].x + obstacles[i].size < 0) {
                    obstacles.splice(i, 1);
                    score += 10; // Increase score
                }

                // Collision detection
                if (
                    player.x < obstacles[i].x + obstacles[i].size &&
                    player.x + player.width > obstacles[i].x &&
                    player.y < obstacles[i].y + obstacles[i].size &&
                    player.y + player.height > obstacles[i].y
                ) {
                    health -= 10;
                    obstacles.splice(i, 1);
                }
            }

            // Draw Score and Health
            ctx.fillStyle = 'white';
            ctx.fillText(`Score: ${score}`, 10, 20);
            ctx.fillText(`Health: ${health}%`, 10, 40);

            if (health > 0) {
                requestAnimationFrame(gameLoop);
            } else {
                alert('Game Over! Your Score: ' + score);
            }
        }

        function drawBackground() {
            // Parallax effect (simplistic)
            // Black background for the night sky
            ctx.fillStyle = 'black';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Draw static stars
            for (let i = 0; i < 100; i++) { // Adjust the number of stars as needed
                const x = Math.random() * canvas.width;
                const y = Math.random() * canvas.height;
                const radius = Math.random() * 1.5; // Adjust star size if needed

                ctx.beginPath();
                ctx.arc(x, y, radius, 0, Math.PI * 2);
                ctx.fillStyle = 'white';
                ctx.fill();
            }

            // Draw static parallax layers (no movement)
            ctx.fillStyle = 'rgba(255,0,0,0.1)';
            ctx.fillRect(0, 0, canvas.width, canvas.height / 3);
            ctx.fillStyle = 'rgba(0,0,255,0.1)';
            ctx.fillRect(0, canvas.height / 3, canvas.width, canvas.height / 3);
        }

        function drawTriangle(x, y, size) {
            ctx.beginPath();
            ctx.moveTo(x, y);
            ctx.lineTo(x + size, y);
            ctx.lineTo(x + size / 2, y - size);
            ctx.closePath();
            ctx.fill();
        }

        gameLoop();
    </script>
</body>

</html>